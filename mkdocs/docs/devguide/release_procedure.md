# Release procedure

To make a new release, follow this checklist.

1. Make sure you're on the dev branch and all features merged in.
2. Create a new version number and codeword. For the version number, use   [semantic versioning](https://semver.org). This means:
    * Version number in MAJOR.MINOR.PATCH format
    * append "-alpha" if we are still in alpha
    * increment the MAJOR number if backward incompatible changes are introduced
    * increment the MINOR number if new, backward compatible changes are introduced OR if deprecating functionality.
    * increment the PATCH number if backward compatible bug fixes are introduced
    * The version codeword is a helpful mnemonic. We were  using a script to generate [Rainbow codes](http://pale.org/rainbow.php), but we've now moved on to [Megalithic sites in the UK](https://m.megalithic.co.uk/asb_mapsquare.php) running through letters of the alphabet and roughly south to north, trying to stick with more memorable names. 
	    * Only increment the name letter for a major release - for example, DRIFT STONES had a minor change, so went to DYNAS COVE rather than (say) EATHORNE.
3. Edit **PCOT/src/pcot/VERSION.txt** to add the new version data, also specifying codename and the date (in ISO 8601, YYYY-MM-DD format).
4. Edit **PCOT/pyproject.toml** to add the new version data (without the codename)
5. Run **poetry install** on both Windows and Linux and check PCOT still runs (and that the title bar and About version data is correct)
7. Create a list of the changes by looking at the Git log and add this
to **PCOT/mkdocs/docs/releases.md** under a new section for the new release.
8. (pyinstaller only)
	1. Make **pyInstaller** builds for Windows and Linux. Do this by going into the **pyInstaller** directory on the required platform and running **pyinstaller file.spec**. Check each build works, fixing if necessary. Note that the splash screen will have been automatically generated by the **file.spec** file from the VERSION.txt, so if it looks weird, check here.
	2. Make a MacOS pyInstaller build. This is more complex, and is shown below.
	3. Upload to the release repo (see below) (not done now we're not using PyInstaller)
10. Commit with "version bump for release (VERSION NAME)" in the text
1. Make sure the dev branch is merged into the master branch.
6. Run **generate_autodocs.py** in **mkdocs** to get up-to-date autodocs.
9. Upload the docs to the documentation site.
11. Make a release tag in the repository, copying the change list from the documentation.
