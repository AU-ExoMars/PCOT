Optimisation: at the moment, setting an output causes a perform.
This means that (say) split, which sets three outputs, causes merge
to perform three times. It doesn't need to.
