<!DOCTYPE html><html lang="en">
    <head>
    
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="robots" content="noindex,nofollow">

        <title>Reading images from multiple files - PCOT Documentation</title>
    
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
    <link rel="stylesheet" href="../../css/lightbox.min.css">
    <link rel="stylesheet" href="../../css/site.css">

    

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/lightbox-plus-jquery.min.js"></script>
 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container ">
                <a class="navbar-brand" href="../..">PCOT Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../gettingstarted/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/installrun/" class="dropdown-item">Installing and running</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/concepts/" class="dropdown-item">PCOT concepts</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/tutorial/" class="dropdown-item">Tutorial</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/inputs/" class="dropdown-item">Loading other image formats</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/help/" class="dropdown-item">Getting help</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../principles/" class="dropdown-item">Operating principles</a>
</li>
                                    
<li>
    <a href="../canvas/" class="dropdown-item">The Canvas</a>
</li>
                                    
<li>
    <a href="../globalcontrols/" class="dropdown-item">Global Controls</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Reading images from multiple files</a>
</li>
                                    
<li>
    <a href="../expr/" class="dropdown-item">The "expr" node for mathematical expressions</a>
</li>
                                    
<li>
    <a href="../batch/" class="dropdown-item">Batch mode</a>
</li>
                                    
<li>
    <a href="../../autodocs/" class="dropdown-item">Autodocs</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Developer's Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../devguide/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../devguide/library/" class="dropdown-item">Using PCOT as a library</a>
</li>
                                    
<li>
    <a href="../../devguide/plugins/" class="dropdown-item">Writing PCOT plugins</a>
</li>
                                    
<li>
    <a href="../../devguide/nodeser/" class="dropdown-item">Node serialisation</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../roadmap/" class="nav-link">Roadmap</a>
                            </li>
                            <li class="navitem">
                                <a href="../../gettingstarted/issues/" class="nav-link">Known issues</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../globalcontrols/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../expr/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container ">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#the-multifile-input-method" class="nav-link">The Multifile input method</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#camera-data-files" class="nav-link">Camera data files</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#finding-out-about-camera-data-with-lscams" class="nav-link">Finding out about camera data with lscams</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#setting-a-camera" class="nav-link">Setting a camera</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#which-image-is-which-filter-setting-a-file-pattern" class="nav-link">Which image is which filter? Setting a file pattern</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#assigning-filters-manually" class="nav-link">Assigning filters manually</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#reading-raw-binary-files" class="nav-link">Reading raw binary files</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#presets" class="nav-link">Presets</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="the-multifile-input-method">The Multifile input method</h1>
<div class="alert alert-primary" role="alert">
<p>Documentation for the other methods is forthcoming.
The regex aspect of multifile is complicated, so documenting it was 
a priority.</p>
</div>
<p>The multifile input method allows multiple monochrome files of "standard"
types like PNG and BMP to be imported as multispectral images. It can
also read raw binary files.</p>
<p>Each file is flattened to greyscale in the process (if it is RGB) by finding
the mean of the three channels for each pixel.</p>
<h2 id="camera-data-files">Camera data files</h2>
<p>In order to analyse the images,
PCOT needs to be able to find out which filter was used for each image
and get information about it. It also needs access to calibration information,
for example flat and dark field images, and reflectance data.</p>
<p>This data is stored in PARC files - PCOT archives - and is 
generated by the <code>pcot gencam</code> command. If you want to know to make them
yourself, read <a href="/userguide/cameradata">this documentation</a>.</p>
<p>However, PCOT already comes with some camera files. These can be found
in the <code>cameras</code> directory inside the PCOT directory. They do not have
flat/dark fields because that data is very large, but hopefully you
will not need them - that stage of processing will take place
upstream in the ROC. Other camera data files can be downloaded
from the <a href="http://pcot.aber.ac.uk/">PCOT Cookbook</a>.</p>
<h2 id="finding-out-about-camera-data-with-lscams">Finding out about camera data with lscams</h2>
<div class="alert alert-info" role="alert">
<p>Some of this information is duplicated in <a href="/userguide/cameradata#listing-camera-data-using-pcot">the camera data docs</a></p>
</div>
<p>You can find out about the camera data installed on your system
with <code>pcot lscams</code> (list cameras). Alone, this will list the cameras
with their short descriptions.</p>
<p>You can get a list of the filters for a camera by using the 
command <code>pcot lscams -f</code>. Alone, this will list all cameras and their
filters, but you can specify a camera: <code>pcot lscams -f TRAINING_GEOLOGY</code>
will list all filters for the geology filter wheel on the training model,
for example (if you have that camera data file installed).</p>
<p>Each filter has a name and a position, as well as other data like centre
wavelength, FWHM and so on. Filters may also have reflectance and 
flat/darkfield data - you can see if this is the case from the 
<code>pcot lscams -l</code> command: if a camera has flats, you'll see "Has flats" in
the description; if it has reflectance data, you'll see a list of 
supported reflectance calibration targets.</p>
<h2 id="setting-a-camera">Setting a camera</h2>
<p>Once you know what camera was used, and you have installed a data
file for that camera, you can set it in the multifile input
using the Camera widget.</p>
<h2 id="which-image-is-which-filter-setting-a-file-pattern">Which image is which filter? Setting a file pattern</h2>
<p>The multifile input method lets you specify a camera, but PCOT still needs to
be able to work out which filter was used to capture each band in the image.
This is done by extracting the filter name or position from the filename using
a regular expression (or <em>regex</em>). If you have some experience with regular
expressions (or access to someone with this experience), it will <a href="https://xkcd.com/208/">help
immensely</a>.</p>
<p>Regular expressions describe patterns which texts might match. For example,
the regex <code>c[a-z]t</code> will match any three-letter string starting with <code>c</code> and
ending with <code>t</code>: it's <code>c</code>, followed by any character between <code>a</code> and <code>z</code>, 
followed by <code>t</code>.</p>
<ul>
<li><a href="https://www.regular-expressions.info/index.html">Beginner's guide</a></li>
<li><a href="https://regex101.com/">Useful 'playground' to try out expressions</a></li>
</ul>
<p>The default pattern looks something like this:</p>
<pre><code class="language-txt">.*[LR]WAC(?P&lt;pos&gt;[0-9][0-9]).*
</code></pre>
<p>This means:</p>
<ul>
<li><code>.*</code> matches any number of any character, so there could be anything
at the start of the filename.</li>
<li><code>[LR]</code> means "either <code>L</code> or <code>R</code>".</li>
<li><code>WAC</code> means we must then have the sequence of letters <code>WAC</code></li>
<li><code>(?P&lt;pos&gt;[0-9][0-9])</code> means we must now match two digits (<code>[0-9]</code>). We've
put them in brackets and preceded them with <code>?P&lt;pos&gt;</code> which means we should
store the result under the name <code>pos</code>.</li>
<li>The final <code>.*</code> means that there can now be any number of any character again -
so there could be anything at the end of the filename.</li>
</ul>
<p>The idea is that a filename like <code>/home/jim/files/DogBiscuitLWAC02Fish.jpg</code>
will be matched, and will result in <code>02</code> being stored as <code>pos</code>, which will
then be used to look up the filter. </p>
<p>You can set the default pattern from the command line with</p>
<pre><code>    pcot setconfig Default.multifile_pattern &quot;your pattern here&quot;
</code></pre>
<h3 id="named-matches-and-how-they-are-used">Named matches and how they are used</h3>
<p>Only one of the following should be true (e.g. you can't use
<code>name</code> and <code>n</code> together):</p>
<ul>
<li><code>lens</code> and <code>n</code>: if these are found, they are joined together
to form a filter position which is looked up in the filter set (by
the position "Pos" field).
The idea is that <code>lens</code> indicates either the left or right camera
and <code>n</code> identifies a filter. They're separate because many early
files used names like <code>LWAC02</code> or <code>LWideAngle02</code>, in which the
two elements were separate. In many cases you'll want to use the <code>pos</code>
option below.</li>
<li><code>pos</code>: if this is found, it us used to match a filter position using the
position field - as such, it's a simpler version of the <code>lens</code>/<code>n</code> combination</li>
<li><code>name</code>: if this is found, it is used to match a filter using the filter's
name</li>
<li><code>cwl</code>: if this is found, it is used to match a filter using the CWL
(wavelength) field</li>
</ul>
<p>If you need assistance, or this isn't flexible enough, contact us - or
maybe use the <em>assignfilters</em> node.</p>
<h2 id="assigning-filters-manually">Assigning filters manually</h2>
<p>Sometimes it's difficult to write a filter pattern to infer the
filters automatically from the filename. In this case, 
you can assign filters in a camera to bands in an image manually
using the <em>assignfilters</em> node (in the "utility" group). This is 
fairly self-explanatory: feed in an image, select a camera, and assign
the bands using the move up and down buttons.</p>
<div class="alert alert-danger" role="alert">
<p>Make very sure that you do this immediately after the <em>input</em> node,
and make all connections from the <em>assignfilters</em> and not directly
from the <em>input</em>.</p>
</div>
<h2 id="reading-raw-binary-files">Reading raw binary files</h2>
<p>Data is often provided "as is" from the camera, in a raw binary format.
Reading these files requires a little more information in advance:</p>
<ul>
<li>What the numeric format of the data is (e.g. 16-bit unsigned integer)</li>
<li>How big the image is in pixels</li>
<li>Whether there is a header at the start which should be skipped and
how big it is (the "offset")</li>
<li>Whether the image needs to be rotated and/or flipped</li>
<li>Whether the data is "big-endian" or "little-endian."</li>
</ul>
<p>These can be set by clicking the "raw loader settings" dialog. </p>
<div class="alert alert-primary" role="alert">
<p>For images from AUPE, the settings are:</p>
<ul>
<li>16-bit unsigned integer</li>
<li>1024x1024</li>
<li>48 byte offset</li>
<li>Rotate 90 degrees</li>
<li>Big-endian data</li>
</ul>
</div>
<h2 id="presets">Presets</h2>
<p>You can save
and load these values - and most other settings for multifile input, such
as the pattern and filter - using the "Presets" button. Presets are currently stored
in your home user directory in a file called <code>MFPresets.json</code>. Users can
easily copy this file from other users.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
