<!DOCTYPE html>
<html lang="en">
    <head>
    
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="robots" content="noindex,nofollow">

        <title>Reading images from multiple files - PCOT Documentation</title>
    
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
    <link rel="stylesheet" href="../../css/lightbox.min.css">
    <link rel="stylesheet" href="../../css/site.css">

    

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/lightbox-plus-jquery.min.js"></script>
 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">PCOT Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../gettingstarted/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/installrun/" class="dropdown-item">Installing and running</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/concepts/" class="dropdown-item">PCOT concepts</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/tutorial/" class="dropdown-item">Tutorial</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/inputs/" class="dropdown-item">Loading other image formats</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/help/" class="dropdown-item">Getting help</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../principles/" class="dropdown-item">Operating principles</a>
</li>
                                    
<li>
    <a href="../canvas/" class="dropdown-item">The Canvas</a>
</li>
                                    
<li>
    <a href="../globalcontrols/" class="dropdown-item">Global Controls</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Reading images from multiple files</a>
</li>
                                    
<li>
    <a href="../expr/" class="dropdown-item">The "expr" node for mathematical expressions</a>
</li>
                                    
<li>
    <a href="../../autodocs/" class="dropdown-item">Autodocs</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Developer's Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../devguide/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../devguide/library/" class="dropdown-item">Using PCOT as a library</a>
</li>
                                    
<li>
    <a href="../../devguide/plugins/" class="dropdown-item">Writing PCOT plugins</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../roadmap/" class="nav-link">Roadmap</a>
                            </li>
                            <li class="navitem">
                                <a href="../../gettingstarted/issues/" class="nav-link">Known issues</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../globalcontrols/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../expr/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#the-multifile-input-method" class="nav-link">The Multifile input method</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#filter-csv-files" class="nav-link">Filter CSV files</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#setting-a-file-pattern" class="nav-link">Setting a file pattern</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="the-multifile-input-method">The Multifile input method</h1>
<div class="alert alert-primary" role="alert">
<p>Documentation for the other methods is forthcoming.
The regex aspect of multifile is complicated, so documenting it was 
a priority.</p>
</div>
<p>The multifile input method allows multiple monochrome files of "standard"
types like PNG and BMP to be imported as multispectral images. Each file
is flattened to greyscale in the process if it is RGB by finding the mean
of the three channels for each pixel.</p>
<p>For this to work, PCOT needs to be able to find out which filter was used
for each image. This is done by storing a set of filters in a CSV file
and using parts of the image files' names to work out which filter is used.</p>
<h2 id="filter-csv-files">Filter CSV files</h2>
<p>Two files are available by default. These are PANCAM (for the actual
ExoMars camera) and AUPE (Aberystwyth PANCAM Emulator). These can be
found in the <code>src/pcot/assets/</code> directory.</p>
<p>Here's an example of part of such a file:</p>
<pre><code class="language-csv">cwl,fwhm,transmission,position,name
570,12,0.989,L01,G04
530,15,0.957,L02,G03
610,10,0.956,L03,G05
</code></pre>
<p>It should be fairly obvious.</p>
<p>If you need to add a new filter set, edit the <code>.pcot.ini</code> file in your 
home directory and a <code>[filters]</code> block if one does not exist. To this block,
add a line like this:</p>
<pre><code class="language-ini">[filters]
myfilterset=filename
</code></pre>
<p>For example</p>
<pre><code class="language-ini">
[filters]
JCFCAM=c:/users/jim/jimfilters.csv
</code></pre>
<p>This new set, called JCFCAM, will be loaded when PCOT is started.</p>
<h2 id="setting-a-file-pattern">Setting a file pattern</h2>
<p>The file pattern is a regular expression
used to work out which filter is used for which image. 
If you have some experience with regular expressions (or access to someone
with this experience), it will <a href="https://xkcd.com/208/">help immensely</a>.</p>
<p>Regular expressions describe patterns which texts might match. For example,
the regex <code>c[a-z]t</code> will match any three-letter string starting with <code>c</code> and
ending with <code>t</code>. </p>
<ul>
<li>(Beginner's guide)[<a href="https://www.regular-expressions.info/index.html">https://www.regular-expressions.info/index.html</a>]</li>
<li>(Useful 'playground' to try out expressions)[<a href="https://regex101.com/">https://regex101.com/</a>]</li>
</ul>
<p>We can also use a regex to extract parts of the string.</p>
<p>The default pattern looks something like this:</p>
<pre><code class="language-txt">.*(?P&lt;lens&gt;L|R)WAC(?P&lt;n&gt;[0-9][0-9]).*
</code></pre>
<p>This means:</p>
<ul>
<li><code>.*</code> matches any number of any character, so there could be anything
at the start of the filename</li>
<li><code>L|R</code> means "either <code>L</code> or <code>R</code>" - but we have specified a "named match"
with brackets and the <code>?P&lt;..&gt;</code> notation: <code>(?P&lt;lens&gt;L|R)</code>. This means 
"either <code>L</code> or <code>R</code> and store the result under the name <code>lens</code>".</li>
<li><code>WAC</code> means we must then have the sequence of letters <code>WAC</code></li>
<li><code>(?P&lt;n&gt;[0-9][0-9])</code> means we must now match two digits (<code>[0-9]</code>) and
store them as <code>n</code></li>
<li>The final <code>.*</code> means that there can now be any number of any character again -
so there could be anything at the end of the filename.</li>
</ul>
<p>The idea is that a filename like <code>/home/jim/files/DogBiscuitLWAC02Fish.jpg</code>
will be matched, and will result in <code>L</code> being stored as <code>lens</code> and 
<code>02</code> being stored as <code>n</code>.</p>
<h3 id="named-matches-and-how-they-are-used">Named matches and how they are used</h3>
<p>Only one of the following should be true (e.g. you can't use
<code>name</code> and <code>n</code> together):</p>
<ul>
<li><code>lens</code> and <code>n</code>: if these are found, they are joined together
to form a filter position which is looked up in the filter set (by
the <code>position</code> column).
The idea is that <code>lens</code> indicates either the left or right camera
and <code>n</code> identifies a filter.</li>
<li><code>name</code>: if this is found, it is used to match a filter using the <code>name</code>
column</li>
<li><code>cwl</code>: if this is found, it is used to match a filter using the <code>cwl</code>
(wavelength) column</li>
</ul>
<p>If you need assistance, or this isn't flexible enough, contact us.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
