<!DOCTYPE html><html lang="en">
    <head>
    
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="robots" content="noindex,nofollow">

        <title>Batch mode - PCOT Documentation</title>
    
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
    <link rel="stylesheet" href="../../css/lightbox.min.css">
    <link rel="stylesheet" href="../../css/site.css">

    

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/lightbox-plus-jquery.min.js"></script>
 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container ">
                <a class="navbar-brand" href="../..">PCOT Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../gettingstarted/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/installrun/" class="dropdown-item">Installing and running</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/concepts/" class="dropdown-item">PCOT concepts</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/tutorial/" class="dropdown-item">Tutorial</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/inputs/" class="dropdown-item">Loading other image formats</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/help/" class="dropdown-item">Getting help</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../principles/" class="dropdown-item">Operating principles</a>
</li>
                                    
<li>
    <a href="../canvas/" class="dropdown-item">The Canvas</a>
</li>
                                    
<li>
    <a href="../globalcontrols/" class="dropdown-item">Global Controls</a>
</li>
                                    
<li>
    <a href="../multifile/" class="dropdown-item">Reading images from multiple files</a>
</li>
                                    
<li>
    <a href="../expr/" class="dropdown-item">The "expr" node for mathematical expressions</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Batch mode</a>
</li>
                                    
<li>
    <a href="../../autodocs/" class="dropdown-item">Autodocs</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Developer's Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../devguide/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../devguide/library/" class="dropdown-item">Using PCOT as a library</a>
</li>
                                    
<li>
    <a href="../../devguide/plugins/" class="dropdown-item">Writing PCOT plugins</a>
</li>
                                    
<li>
    <a href="../../devguide/nodeser/" class="dropdown-item">Node serialisation</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../roadmap/" class="nav-link">Roadmap</a>
                            </li>
                            <li class="navitem">
                                <a href="../../gettingstarted/issues/" class="nav-link">Known issues</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../expr/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../autodocs/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container ">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#batch-mode" class="nav-link">Batch mode</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="batch-mode">Batch mode</h1>
<p>Batch files - sometimes called parameter files - let you create a PCOT graph
and then run it several times from the command line, modifying its inputs,
outputs or nodes each time.</p>
<p>For example, imagine that we have a graph like this to generate a false colour
spectral parameter map across an entire image:</p>
<p><img alt="A simple graph" src="gradient.png" /></p>
<p>The <em>expr</em> node is set to the parameter we want to generate, which
in this case is <code>a$670/(a$440+0.1)</code> and we've renamed it back to
<em>expr</em> for reasons which will become apparent (<em>expr</em> nodes usually change
their name to their expression).</p>
<p>The
<em>gradient</em> node is set to the defaults, but with the legend in the left margin
rather than inside the image.</p>
<p>When we run this on some data (assuming it has the two wavelengths we need),
and right-click on the image inside the <em>gradient</em> node, we can save as a PDF.
That PDF will look something like this:</p>
<p><figure class="text-center"><a data-lightbox="gradient_result.png" href="gradient_result.png"><img alt="Example spectral parameter map" src="gradient_result.png" style="max-height:400px;" /></a><figcaption class="figure-caption text-center">Figure: Example spectral parameter map. Click on image to expand.</figcaption></figure></p>
<p>This is great, but we might want to run this on multiple images. We can
do that using batch files. For example, this file will use the same
settings for all the nodes and inputs, but replace the input filenames
with those specified (we're using a <a href="/userguide/multifile">multifile</a> input
here):</p>
<pre><code class="language-txt">inputs.0.multifile.directory = H:\PancamData\SamplesGeologyFilter
inputs.0.multifile.filenames.+ = R01.bin
.+ = R02.bin
.+ = R03.bin
.+ = R04.bin
.+ = R05.bin
.+ = R06.bin

outputs.+.node=gradient
.file=gradient.pdf
.annotations=y
.clobber=y
</code></pre>
<p>The inputs will keep their settings (e.g. raw loader parameters and filter)
but new files will be used.</p>
<p>If we want to do this several times, we can either write multiple batch
files, or we can run the graph several times in one file, changing it
each time. Here's an example that runs the graph twice:</p>
<pre><code class="language-txt">inputs.0.multifile.directory = H:\PancamData\SamplesGeologyFilter
inputs.0.multifile.filenames.+ = R01.bin
.+ = R02.bin
.+ = R03.bin
.+ = R04.bin
.+ = R05.bin
.+ = R06.bin

outputs.+.node=gradient
.file=gradient1.pdf
.annotations=y
.clobber=y

run

inputs.0.multifile.directory = H:\PancamData\Data2
expr.expr = a$440
gradient.preset = magma
reset inputs.0.multifile.filenames
inputs.0.multifile.filenames.+ = *1712*Training Model-R01*.bin
inputs.0.multifile.filenames.+ = *1713*Training Model-R05*.bin
outputs.0.file = gradient2.pdf
run
</code></pre>
<p>Here, we are running the graph once as above and then making some changes:</p>
<ul>
<li>changing the input directory</li>
<li>changing the input to read different filenames, this time loaded using <a href="https://tldp.org/LDP/GNU-Linux-Tools-Summary/html/x11655.htm">"wildcards"</a></li>
<li>changing the <em>expr</em> node's expression to show just the 440nm channel</li>
<li>changing the gradient's appearance with a preset</li>
<li>changing the output to write to a different filename</li>
</ul>
<div class="alert alert-danger fw-bold" role="alert">
<p>Write more on how the inputs work - intro here, more in params.md or
elsewhere. Write more in general. Note <a href="/autodocs">autodocs</a>.</p>
<p>Finish.</p>
</div>
<ul>
<li><a href="params/">Parameter file format</a></li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
