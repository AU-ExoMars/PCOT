<!DOCTYPE html>
<html lang="en">
    <head>
    
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="robots" content="noindex,nofollow">

        <title>Important classes - PCOT Documentation</title>
    
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <link rel="stylesheet" href="../../css/lightbox.min.css">
    <link rel="stylesheet" href="../../css/site.css">

    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
    <script src="../../js/lightbox-plus-jquery.min.js"></script>
 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">PCOT Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../gettingstarted/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/installrun/" class="dropdown-item">Installing and running</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/concepts/" class="dropdown-item">PCOT concepts</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/tutorial/" class="dropdown-item">Tutorial</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/inputs/" class="dropdown-item">Loading other image formats</a>
</li>
                                    
<li>
    <a href="../../gettingstarted/help/" class="dropdown-item">Getting help</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../userguide/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../userguide/principles/" class="dropdown-item">Operating principles</a>
</li>
                                    
<li>
    <a href="../../userguide/canvas/" class="dropdown-item">The Canvas</a>
</li>
                                    
<li>
    <a href="../../userguide/globalcontrols/" class="dropdown-item">Global Controls</a>
</li>
                                    
<li>
    <a href="../../userguide/multifile/" class="dropdown-item">Reading images from multiple files</a>
</li>
                                    
<li>
    <a href="../../userguide/expr/" class="dropdown-item">The "expr" node for mathematical expressions</a>
</li>
                                    
<li>
    <a href="../../autodocs/" class="dropdown-item">Autodocs</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Developer's Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../library/" class="dropdown-item">Using PCOT as a library</a>
</li>
                                    
<li>
    <a href="../plugins/" class="dropdown-item">Writing PCOT plugins</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../roadmap/" class="nav-link">Roadmap</a>
                            </li>
                            <li class="navitem">
                                <a href="../../gettingstarted/issues/" class="nav-link">Known issues</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#important-classes" class="nav-link">Important classes</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#pcotdocumentdocument-and-an-overview" class="nav-link">pcot.document.Document, and an overview</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pcotxformxformgraph" class="nav-link">pcot.xform.XFormGraph</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pcotxformxform" class="nav-link">pcot.xform.XForm</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pcotdatumdatum" class="nav-link">pcot.datum.Datum</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pcotdatumtypestype" class="nav-link">pcot.datumtypes.Type</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pcotimagecubeimagecube" class="nav-link">pcot.imagecube.ImageCube</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pcotimagecubesubimagecube" class="nav-link">pcot.imagecube.SubImageCube</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pcotvaluevalue" class="nav-link">pcot.value.Value</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="important-classes">Important classes</h1>
<h2 id="pcotdocumentdocument-and-an-overview">pcot.document.Document, and an overview</h2>
<ul>
<li>PCOT keeps all its user data in a <strong>pcot.document.Document</strong>:
This contains:<ul>
<li>a <strong>pcot.documentsettings.DocumentSettings</strong> object</li>
<li>a <strong>pcot.inputs.inp.InputManager</strong> object handling the inputs</li>
<li>a <strong>pcot.document.UndoRedoStore</strong> which uses the serialisation/deserialisation
system to handle an undo stack</li>
<li>A dictionary of <strong>pcot.macros.XFormMacro</strong> objects - the user macros</li>
<li>most importantly a <strong>pcot.xform.XFormGraph</strong> - a set of 
nodes of type <strong>pcot.xform.XForm</strong> connected together
to do things.</li>
</ul>
</li>
<li>Each XForm points to a <strong>pcot.xform.XFormType</strong> singleton which
controls its behaviour.</li>
<li>Nodes (XForms) communicate by passing <strong>pcot.datum.Datum</strong> objects.</li>
<li>Each Datum points to a <strong>pcot.datumtype.Type</strong> subclass singleton
providing serialisation, copy, and display facilities.</li>
<li>They also point have values - two common value classes are
<strong>pcot.imagecube.ImageCube</strong> for images, and <strong>pcot.value.Value</strong>
objects for other arrays and scalars.</li>
<li>ImageCubes can generate <strong>SubImageCube</strong> objects which are subsets of
the image covered by ROIs and with bad pixels masked out ("bad" according
to the data quality bits).</li>
</ul>
<h2 id="pcotxformxformgraph">pcot.xform.XFormGraph</h2>
<p>This represents the graph of nodes which take data from inputs and perform
operations on them. There is one inside the document, and instances of
macros also contain their own graphs (and the macro itself contains a "template"
graph from which these are created).</p>
<p>A graph contains:</p>
<ul>
<li>A set of <strong>pcot.xform.XForm</strong> objects (usually called <strong>nodes</strong>)
connected together by their <code>inputs</code> fields, which are tuples of 
(source node, index of output).</li>
<li>A graph runs by finding those nodes which have no inputs and performing them;
the entire graph will be recursively traversed.</li>
<li>Nodes are only run if their inputs have data (if their parent nodes have run).</li>
</ul>
<h2 id="pcotxformxform">pcot.xform.XForm</h2>
<ul>
<li>All nodes are of the same type. Polymorphism - different nodes behaving
differently - is accomplished through each node having a reference to
a <strong>pcot.xform.XFormType</strong> object in its <code>type</code> member
that controls its behaviour.</li>
<li>Nodes communicate by passing <strong>pcot.datum.Datum</strong> objects.</li>
<li>When a node runs its <code>perform</code> method<ul>
<li>It reads the inputs by deferencing the <code>inputs</code> fields and
getting the input node and index of the output of that node,
and reading the Datum stored in that output.</li>
<li>It processes the data and stores the results in its <code>outputs</code> field
as Datum objects.</li>
<li>It then performs its "child" nodes.</li>
</ul>
</li>
</ul>
<h2 id="pcotdatumdatum">pcot.datum.Datum</h2>
<p>This is the fundamental data type, used both for communicating between
nodes and handling values in the <em>expr</em> node. A Datum has</p>
<ul>
<li>a <strong>type</strong>, which is a <strong>pcot.datumtypes.Type</strong> object</li>
<li>a <strong>value</strong>, whose type depends on the type field</li>
<li>a <strong>source</strong> indicating where the data came from</li>
</ul>
<p>If the value is <code>None</code>, the Datum is null. There is a constant
<code>Datum.null</code> for null data.</p>
<h2 id="pcotdatumtypestype">pcot.datumtypes.Type</h2>
<p>The DatumType object provides methods for serialisation, copying,
and display. Each is a singleton. It's easy to create custom DatumTypes.
The most commonly used builtins are:</p>
<ul>
<li><strong>Datum.IMG</strong>:  contains an <strong>ImageCube</strong></li>
<li><strong>Datum.NUMBER</strong>: contains a <strong>Value</strong></li>
</ul>
<p>(these names are for the singleton objects, not their types - for example,
<code>Datum.IMG</code> has the type <code>pcot.datumtypes.ImgType</code>.)</p>
<h2 id="pcotimagecubeimagecube">pcot.imagecube.ImageCube</h2>
<p>This is the fundamental image type, consisting of</p>
<ul>
<li><strong>image data</strong> - 2D (H x W) if there is only one band (channel), 
3D otherwise (H x W x D). Type is float32.</li>
<li><strong>uncertainty data</strong>, same shape and type as image data. This is the
standard deviation of each pixel.</li>
<li><strong>DQ data</strong>. This a 16-bit bitfield for each pixel. Some
of these are considered errors - these are called "bad" DQ bits
(e.g. no uncertainty, saturated, results from a division by zero).</li>
<li><strong>regions of interest</strong></li>
<li><strong>annotations</strong> that have been added to the image</li>
<li><strong>mapping</strong> used to render the image as RGB</li>
<li><strong>sources</strong> for each band</li>
</ul>
<h2 id="pcotimagecubesubimagecube">pcot.imagecube.SubImageCube</h2>
<p>These objects can be generated by calling the <strong>subimg()</strong> method on an
ImageCube. They are the subset of an image covered by the regions of 
interest it has, along with a mask for those regions. Additionally,
"bad" parts of the image (which can be different in different bands)
can be masked out. </p>
<p>Operations on images are typically done on these
subimages, and then <strong>modifyWithSub</strong> is called on the imagecube to
return a copy of that imagecube with the modified subimage spliced
in. Useful subimage methods include:</p>
<ul>
<li><strong>masked()</strong>: return the masked nominal image data</li>
<li><strong>maskedUncertainty()</strong>: return the masked uncertainty data</li>
<li><strong>maskedDQ()</strong>: return the masked DQ bits</li>
</ul>
<p>All these return numpy masked arrays.</p>
<h2 id="pcotvaluevalue">pcot.value.Value</h2>
<p>This is the fundamental numeric type, consisting of</p>
<ul>
<li>nominal value</li>
<li>uncertainty value (standard deviation)</li>
<li>DQ bits</li>
</ul>
<p>It's usually used for scalars but can also hold array data. If it
does hold array data, the three elements must be the same shape.</p>
<p>This type supports mathematical operations which propagate uncertainty
and DQ.</p>
<div class="alert alert-info" role="alert">
<p><strong>Note</strong>: You may wonder why ImageCube and SubImageCube don't use
Value internally. The answer is simply historical reasons: they
were created a very long time before Value, and refactoring now
could cause huge problems.</p>
</div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/jquery-3.6.0.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
